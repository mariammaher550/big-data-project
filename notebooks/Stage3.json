{"paragraphs":[{"text":"%sh\npip install pyspark","user":"anonymous","dateUpdated":"2023-05-10T17:09:15+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DEPRECATION: Python 2.7 reached the end of its life on January 1st, 2020. Please upgrade your Python as Python 2.7 is no longer maintained. pip 21.0 will drop support for Python 2.7 in January 2021. More details about Python 2 support in pip can be found at https://pip.pypa.io/en/latest/development/release-process/#python-2-support pip 21.0 will remove support for this functionality.\nDefaulting to user installation because normal site-packages is not writeable\nRequirement already satisfied: pyspark in /usr/lib/python2.7/site-packages (3.0.3)\nRequirement already satisfied: py4j==0.10.9 in /usr/lib/python2.7/site-packages (from pyspark) (0.10.9)\n"}]},"apps":[],"jobName":"paragraph_1683738512655_609504922","id":"20230510-170832_125503091","dateCreated":"2023-05-10T17:08:32+0000","dateStarted":"2023-05-10T17:09:15+0000","dateFinished":"2023-05-10T17:09:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2198"},{"text":"%python2\nimport pyspark.sql.functions as F\nfrom pyspark.sql import SparkSession\nfrom pyspark.ml import Pipeline\n\nspark = SparkSession.builder.appName(\"BDT Project\").master(\"local[*]\").config(\"hive.metastore.uris\", \"thrift://sandbox-hdp.hortonworks.com:9083\").config(\"spark.sql.catalogImplementation\",\"hive\").config(\"spark.sql.avro.compression.codec\", \"snappy\").config(\"spark.jars\", \"file:///usr/hdp/current/hive-client/lib/hive-metastore-1.2.1000.2.6.5.0-292.jar,file:///usr/hdp/current/hive-client/lib/hive-exec-1.2.1000.2.6.5.0-292.jar\").config(\"spark.jars.packages\",\"org.apache.spark:spark-avro_2.12:3.0.3\").enableHiveSupport().getOrCreate()\n\nsc = spark.sparkContext\nprint(sc)","user":"anonymous","dateUpdated":"2023-05-10T22:42:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Warning: Ignoring non-Spark config property: hive.metastore.uris\nIvy Default Cache set to: /home/zeppelin/.ivy2/cache\nThe jars for the packages stored in: /home/zeppelin/.ivy2/jars\n:: loading settings :: url = jar:file:/usr/lib/python2.7/site-packages/pyspark/jars/ivy-2.4.0.jar!/org/apache/ivy/core/settings/ivysettings.xml\norg.apache.spark#spark-avro_2.12 added as a dependency\n:: resolving dependencies :: org.apache.spark#spark-submit-parent-7e98c6f0-058b-4ff2-bbeb-145c94b2ea51;1.0\n\tconfs: [default]\n\tfound org.apache.spark#spark-avro_2.12;3.0.3 in central\n\tfound org.spark-project.spark#unused;1.0.0 in central\n:: resolution report :: resolve 588ms :: artifacts dl 10ms\n\t:: modules in use:\n\torg.apache.spark#spark-avro_2.12;3.0.3 from central in [default]\n\torg.spark-project.spark#unused;1.0.0 from central in [default]\n\t---------------------------------------------------------------------\n\t|                  |            modules            ||   artifacts   |\n\t|       conf       | number| search|dwnlded|evicted|| number|dwnlded|\n\t---------------------------------------------------------------------\n\t|      default     |   2   |   0   |   0   |   0   ||   2   |   0   |\n\t---------------------------------------------------------------------\n:: retrieving :: org.apache.spark#spark-submit-parent-7e98c6f0-058b-4ff2-bbeb-145c94b2ea51\n\tconfs: [default]\n\t0 artifacts copied, 2 already retrieved (0kB/9ms)\n23/05/10 22:43:28 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable\nSetting default log level to \"WARN\".\nTo adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).\n/usr/lib/python2.7/site-packages/pyspark/context.py:227: DeprecationWarning: Support for Python 2 and Python 3 prior to version 3.6 is deprecated as of Spark 3.0. See also the plan for dropping Python 2 support at https://spark.apache.org/news/plan-for-dropping-python-2-support.html.\n  DeprecationWarning)\n<SparkContext master=local[*] appName=BDT Project>\n"}]},"apps":[],"jobName":"paragraph_1683552101804_20935845","id":"20230508-132141_1714334507","dateCreated":"2023-05-08T13:21:41+0000","dateStarted":"2023-05-10T22:42:52+0000","dateFinished":"2023-05-10T22:43:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2199"},{"text":"print(spark.catalog.listDatabases())","user":"anonymous","dateUpdated":"2023-05-10T17:54:33+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"23/05/10 17:54:37 WARN shortcircuit.DomainSocketFactory: The short-circuit local reads feature cannot be used because libhadoop cannot be loaded.\n\n[Stage 0:>                                                          (0 + 0) / 1]\n\n[Stage 0:>                                                          (0 + 1) / 1]\n\n                                                                                \n[Database(name=u'default', description=u'Default Hive database', locationUri=u'hdfs://sandbox-hdp.hortonworks.com:8020/apps/hive/warehouse'), Database(name=u'foodmart', description=u'', locationUri=u'hdfs://sandbox-hdp.hortonworks.com:8020/apps/hive/warehouse/foodmart.db'), Database(name=u'projectdb', description=u'', locationUri=u'hdfs://sandbox-hdp.hortonworks.com:8020/apps/hive/warehouse/projectdb.db')]\n"}]},"apps":[],"jobName":"paragraph_1683738496655_-1922942987","id":"20230510-170816_1079750903","dateCreated":"2023-05-10T17:08:16+0000","dateStarted":"2023-05-10T17:54:33+0000","dateFinished":"2023-05-10T17:54:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2200"},{"text":"print(spark.catalog.listTables(\"projectdb\"))","user":"anonymous","dateUpdated":"2023-05-10T17:54:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[Table(name=u'book_ratings', database=u'projectdb', description=None, tableType=u'EXTERNAL', isTemporary=False), Table(name=u'books', database=u'projectdb', description=None, tableType=u'EXTERNAL', isTemporary=False), Table(name=u'users', database=u'projectdb', description=None, tableType=u'EXTERNAL', isTemporary=False)]\n"}]},"apps":[],"jobName":"paragraph_1683552333155_-502986532","id":"20230508-132533_592054271","dateCreated":"2023-05-08T13:25:33+0000","dateStarted":"2023-05-10T17:54:58+0000","dateFinished":"2023-05-10T17:55:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2201"},{"text":"users = spark.read.format(\"avro\").table('projectdb.users')\nbooks = spark.read.format(\"avro\").table('projectdb.books')\nbook_ratings = spark.read.format(\"avro\").table('projectdb.book_ratings')\n\nusers.createOrReplaceTempView('users')\nbooks.createOrReplaceTempView('books')\nbook_ratings.createOrReplaceTempView('book_ratings')","user":"anonymous","dateUpdated":"2023-05-10T22:54:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1683552450312_1020419898","id":"20230508-132730_1555863196","dateCreated":"2023-05-08T13:27:30+0000","dateStarted":"2023-05-10T22:54:50+0000","dateFinished":"2023-05-10T17:55:11+0000","status":"RUNNING","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2202"},{"text":"users.printSchema()\nbooks.printSchema()\nbook_ratings.printSchema()\n\nspark.sql(\"SELECT * FROM book_ratings\").show()","user":"anonymous","dateUpdated":"2023-05-10T17:18:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- user_id: integer (nullable = true)\n |-- location: string (nullable = true)\n |-- age: integer (nullable = true)\n\nroot\n |-- isbn: string (nullable = true)\n |-- book_title: string (nullable = true)\n |-- book_author: string (nullable = true)\n |-- year_of_publication: integer (nullable = true)\n |-- publisher: string (nullable = true)\n\nroot\n |-- user_id: integer (nullable = true)\n |-- isbn: string (nullable = true)\n |-- rating: integer (nullable = true)\n\n\n[Stage 6:>                                                          (0 + 1) / 1]\n\n                                                                                \n+-------+----------+------+\n|user_id|      isbn|rating|\n+-------+----------+------+\n| 276725|034545104X|     0|\n| 276726| 155061224|     5|\n| 276727| 446520802|     0|\n| 276729|052165615X|     3|\n| 276729| 521795028|     6|\n| 276733|2080674722|     0|\n| 276744|038550120X|     7|\n| 276746| 425115801|     0|\n| 276746| 449006522|     0|\n| 276746| 553561618|     0|\n| 276746|055356451X|     0|\n| 276746| 786013990|     0|\n| 276746| 786014512|     0|\n| 276747|  60517794|     9|\n| 276747| 451192001|     0|\n| 276747| 609801279|     0|\n| 276747| 671537458|     9|\n| 276747| 679776818|     8|\n| 276747| 943066433|     7|\n| 276747|1570231028|     0|\n+-------+----------+------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1683552588803_1299914521","id":"20230508-132948_856622907","dateCreated":"2023-05-08T13:29:48+0000","dateStarted":"2023-05-10T17:18:40+0000","dateFinished":"2023-05-10T17:18:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2203"},{"text":"from pyspark.sql.functions import col\n\n\n# Join users table with book_ratings table\njoined_df = users.join(book_ratings, on='user_id')\n\n# Join joined_df with books table\njoined_df = joined_df.join(books, on='isbn')\n\n\n# Select columns and rename them\ndataset = joined_df.select(col('user_id'), col('isbn'), col('location'), col('age'), col('book_title'), col('book_author'), col('year_of_publication'),col('publisher'), col('rating'))\n\ndataset.show(10)","user":"anonymous","dateUpdated":"2023-05-10T17:55:14+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"... ... ... \n[Stage 6:>                                                          (0 + 1) / 1]\n\n                                                                                \n\n[Stage 7:>                  (0 + 1) / 1][Stage 8:>                  (0 + 1) / 1]\n\n[Stage 7:>                                                          (0 + 1) / 1]\n\n                                                                                \n+-------+----------+--------------------+---+--------------------+------------------+-------------------+--------------------+------+\n|user_id|      isbn|            location|age|          book_title|       book_author|year_of_publication|           publisher|rating|\n+-------+----------+--------------------+---+--------------------+------------------+-------------------+--------------------+------+\n|  60337|006017367X|st. marys, georgi...| 50|The Wit &amp; Wis...|       Oscar Wilde|               1996|       Harpercollins|     9|\n| 206202|006100328X|arlington heights...| 16|Doorways in the Sand|     Roger Zelazny|               1991|Harper Mass Marke...|    10|\n|  31139|006105206X|edmonton, alberta...| 36|Gold: The Final S...|      Isaac Asimov|               1995|       Harpercollins|     0|\n| 197659|006105206X|indiana, pennsylv...| 49|Gold: The Final S...|      Isaac Asimov|               1995|       Harpercollins|     9|\n| 204864|006105206X|simi valley, cali...| 47|Gold: The Final S...|      Isaac Asimov|               1995|       Harpercollins|     0|\n| 213350|006105206X|rowland heights, ...| 65|Gold: The Final S...|      Isaac Asimov|               1995|       Harpercollins|     0|\n| 232103|006105206X|durham, north car...| 30|Gold: The Final S...|      Isaac Asimov|               1995|       Harpercollins|     6|\n| 135149|006105934X|ft. pierce, flori...| 34|X-Files Film Nove...|      Chris Carter|               1998| HarperEntertainment|     0|\n|  29757|009956520X|davoren park, sou...| 38|               Korea|   Alexander Bevin|               1989|Arrow (A Division...|     0|\n| 246655|014008102X|mooresville, nort...| 34|Secrets, and othe...|Bernard MacLaverty|               1985|       Penguin Books|     0|\n+-------+----------+--------------------+---+--------------------+------------------+-------------------+--------------------+------+\nonly showing top 10 rows\n\n"}]},"apps":[],"jobName":"paragraph_1683580400167_-2014986466","id":"20230508-211320_484851050","dateCreated":"2023-05-08T21:13:20+0000","dateStarted":"2023-05-10T17:55:14+0000","dateFinished":"2023-05-10T17:55:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2204"},{"text":"dataset.printSchema()","user":"anonymous","dateUpdated":"2023-05-10T17:56:22+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- user_id: integer (nullable = true)\n |-- isbn: string (nullable = true)\n |-- location: string (nullable = true)\n |-- age: integer (nullable = true)\n |-- book_title: string (nullable = true)\n |-- book_author: string (nullable = true)\n |-- year_of_publication: integer (nullable = true)\n |-- publisher: string (nullable = true)\n |-- rating: integer (nullable = true)\n\n"}]},"apps":[],"jobName":"paragraph_1683580914636_625111225","id":"20230508-212154_818005181","dateCreated":"2023-05-08T21:21:54+0000","dateStarted":"2023-05-10T17:56:22+0000","dateFinished":"2023-05-10T17:56:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2205"},{"text":"# Preprocessing table dataset\nfrom pyspark.ml.feature import StringIndexer\nfrom pyspark.ml import Pipeline\n\n# handling string columns\nindexer = [StringIndexer(inputCol=column, outputCol=column+\"_index\") for column in ['isbn', 'location', 'book_title', 'book_author', 'publisher']]\npipeline = Pipeline(stages=indexer)\ndataset  = pipeline.fit(dataset).transform(dataset)\ndataset = dataset.select(['user_id', 'isbn_index', 'location_index', 'age', 'book_title_index', 'book_author_index', 'year_of_publication', 'publisher_index', 'rating']).withColumnRenamed('isbn_index', 'isbn').withColumnRenamed('location_index', 'location').withColumnRenamed('book_title_index', 'book_title').withColumnRenamed('book_author_index', 'book_author').withColumnRenamed('publisher_index', 'publisher')\ndataset.show()","user":"anonymous","dateUpdated":"2023-05-10T17:56:29+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"... ... \n[Stage 10:>                 (0 + 1) / 1][Stage 11:>                 (0 + 1) / 1]\n\n                                                                                \n\n[Stage 10:>                                                         (0 + 1) / 1]\n\n                                                                                \n\n[Stage 12:>                                                         (0 + 1) / 1]\n\n[Stage 13:>                                                         (0 + 1) / 1]\n\n                                                                                \n\n[Stage 14:>                 (0 + 1) / 1][Stage 15:>                 (0 + 1) / 1]\n\n                                                                                \n\n[Stage 15:>                                                         (0 + 1) / 1]\n\n                                                                                \n\n[Stage 16:>                                                         (0 + 1) / 1]\n\n                                                                                \n\n[Stage 18:>                 (0 + 1) / 1][Stage 19:>                 (0 + 1) / 1]\n\n                                                                                \n\n[Stage 19:>                                                         (0 + 1) / 1]\n\n                                                                                \n\n[Stage 20:>                                                         (0 + 1) / 1]\n\n[Stage 21:>                                                         (0 + 1) / 1]\n\n                                                                                \n\n[Stage 22:>                 (0 + 1) / 1][Stage 23:>                 (0 + 1) / 1]\n\n                                                                                \n\n[Stage 22:>                                                         (0 + 1) / 1]\n\n                                                                                \n\n[Stage 24:>                                                         (0 + 1) / 1]\n\n                                                                                \n\n[Stage 26:>                 (0 + 1) / 1][Stage 27:>                 (0 + 1) / 1]\n\n                                                                                \n\n[Stage 27:>                                                         (0 + 1) / 1]\n\n                                                                                \n\n[Stage 28:>                                                         (0 + 1) / 1]\n\n                                                                                \n\n[Stage 30:>                                                         (0 + 1) / 1]\n\n                                                                                \n\n[Stage 31:>                                                         (0 + 1) / 1]\n\n[Stage 31:>                 (0 + 1) / 1][Stage 32:>                 (0 + 1) / 1]\n\n[Stage 32:>                                                         (0 + 1) / 1]\n23/05/10 17:57:29 WARN scheduler.DAGScheduler: Broadcasting large task binary with size 29.3 MiB\n\n[Stage 33:>                                                         (0 + 0) / 1]\n\n[Stage 33:>                                                         (0 + 1) / 1]\n\n                                                                                \n+-------+--------+--------+---+----------+-----------+-------------------+---------+------+\n|user_id|    isbn|location|age|book_title|book_author|year_of_publication|publisher|rating|\n+-------+--------+--------+---+----------+-----------+-------------------+---------+------+\n|  60337|116290.0|   669.0| 50|  215903.0|      236.0|               1996|     25.0|     9|\n| 206202|116477.0|   852.0| 16|   74630.0|      564.0|               1991|     42.0|    10|\n|  31139| 29787.0|    29.0| 36|   31069.0|      105.0|               1995|     25.0|     0|\n| 197659| 29787.0|   173.0| 49|   31069.0|      105.0|               1995|     25.0|     9|\n| 204864| 29787.0|    35.0| 47|   31069.0|      105.0|               1995|     25.0|     0|\n| 213350| 29787.0|    94.0| 65|   31069.0|      105.0|               1995|     25.0|     0|\n| 232103| 29787.0|   209.0| 30|   31069.0|      105.0|               1995|     25.0|     6|\n| 135149|116499.0|    62.0| 34|  228986.0|    15622.0|               1998|    171.0|     0|\n|  29757|116698.0|  8577.0| 38|  158482.0|    50262.0|               1989|    660.0|     0|\n| 246655|116803.0|    89.0| 34|  187837.0|     6389.0|               1985|      9.0|     0|\n| 278188|116945.0|   820.0| 34|  109901.0|    32301.0|               1995|     58.0|     0|\n|  15418| 29813.0|   607.0| 23|   27145.0|     2621.0|               1971|      9.0|     0|\n|  58156| 29813.0|  2313.0| 58|   27145.0|     2621.0|               1971|      9.0|     0|\n| 191202| 29813.0|   867.0| 34|   27145.0|     2621.0|               1971|      9.0|     7|\n| 201526| 29813.0|    24.0| 25|   27145.0|     2621.0|               1971|      9.0|     0|\n| 231210| 29813.0|    48.0| 44|   27145.0|     2621.0|               1971|      9.0|     0|\n| 278418| 37402.0|     5.0| 34|   44978.0|     7334.0|               1968|     54.0|     0|\n|  76499| 37402.0|    23.0| 34|   44978.0|     7334.0|               1968|     54.0|    10|\n| 117539| 37402.0|   515.0| 30|   44978.0|     7334.0|               1968|     54.0|     0|\n| 163194| 37402.0|  3370.0| 57|   44978.0|     7334.0|               1968|     54.0|     0|\n+-------+--------+--------+---+----------+-----------+-------------------+---------+------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1683554820711_492730465","id":"20230508-140700_1736092888","dateCreated":"2023-05-08T14:07:00+0000","dateStarted":"2023-05-10T17:56:29+0000","dateFinished":"2023-05-10T17:57:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2206"},{"text":"# Now we will build a system that tries to predict the rating of a user to a book\n# The data that will be used is from the book_ratings table only\nfrom pyspark.ml.feature import VectorAssembler\n(training, test) = dataset.randomSplit([0.7, 0.3])\nassembler = VectorAssembler(inputCols=[\"user_id\", \"isbn\", 'location', 'age', 'book_title', 'book_author', 'year_of_publication', 'publisher'], outputCol=\"features\")\ntraining = assembler.transform(training)\ntest = assembler.transform(test)","user":"anonymous","dateUpdated":"2023-05-10T17:59:06+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1683555046936_1937966115","id":"20230508-141046_932879147","dateCreated":"2023-05-08T14:10:46+0000","dateStarted":"2023-05-10T17:59:06+0000","dateFinished":"2023-05-10T17:59:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2207"},{"text":"training.show(5)","user":"anonymous","dateUpdated":"2023-05-10T17:22:01+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\n[Stage 35:>                                                         (0 + 1) / 1]\n\n                                                                                \n\n[Stage 36:>                 (0 + 1) / 1][Stage 37:>                 (0 + 1) / 1]\n\n[Stage 37:>                                                         (0 + 1) / 1]\n\n[Stage 38:>                                                         (0 + 0) / 1]\n23/05/10 17:22:49 WARN scheduler.DAGScheduler: Broadcasting large task binary with size 29.4 MiB\n\n[Stage 38:>                                                         (0 + 1) / 1]\n\n                                                                                \n+-------+--------+--------+---+----------+-----------+-------------------+---------+------+--------------------+\n|user_id|    isbn|location|age|book_title|book_author|year_of_publication|publisher|rating|            features|\n+-------+--------+--------+---+----------+-----------+-------------------+---------+------+--------------------+\n|    741|  3024.0|  1859.0| 16|    3350.0|      118.0|               2002|      8.0|     0|[741.0,3024.0,185...|\n|    850| 25850.0|   678.0| 22|   27276.0|      289.0|               1999|    141.0|     9|[850.0,25850.0,67...|\n|    929| 14709.0|  2030.0| 36|    4207.0|      149.0|               1992|     16.0|     0|[929.0,14709.0,20...|\n|   1903|217479.0|   971.0| 36|  214763.0|    70522.0|               2000|    539.0|     0|[1903.0,217479.0,...|\n|   2276|120189.0|   335.0| 46|  149867.0|    18476.0|               1976|     27.0|     0|[2276.0,120189.0,...|\n+-------+--------+--------+---+----------+-----------+-------------------+---------+------+--------------------+\nonly showing top 5 rows\n\n"}]},"apps":[],"jobName":"paragraph_1683581578190_1524574768","id":"20230508-213258_2133201866","dateCreated":"2023-05-08T21:32:58+0000","dateStarted":"2023-05-10T17:22:02+0000","dateFinished":"2023-05-10T17:22:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2208"},{"text":"# # cross validation and hyperparameter tuning.\n# from pyspark.ml import Pipeline\n# from pyspark.ml.tuning import CrossValidator, ParamGridBuilder\n# from pyspark.ml.recommendation import ALS\n# from pyspark.ml.evaluation import RankingEvaluator\n\n# als = ALS(userCol=\"user_id\", maxIter=5, regParam=0.01, itemCol=\"isbn\", ratingCol=\"rating\", coldStartStrategy=\"drop\")\n# pipeline = Pipeline(stages=[als])\n# paramGrid = ParamGridBuilder().addGrid(als.rank, [10, 25, 50]).addGrid(als.regParam,[0.001, 0.01, 1]).build()\n\n# crossval = CrossValidator(estimator=pipeline, estimatorParamMaps=paramGrid, evaluator=RankingEvaluator(labelCol=\"rating\", predictionCol=\"prediction\", metricName=\"meanAveragePrecision\"),numFolds=4)\n\n# als_cvModel = crossval.fit(training)","user":"anonymous","dateUpdated":"2023-05-10T17:22:41+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1683739332589_1955537176","id":"20230510-172212_1986410156","dateCreated":"2023-05-10T17:22:12+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:2209"},{"text":"# cross validation and hyperparameter tuning.\nfrom pyspark.ml import Pipeline\nfrom pyspark.ml.tuning import CrossValidator, ParamGridBuilder\nfrom pyspark.ml.recommendation import ALS\nfrom pyspark.ml.evaluation import RankingEvaluator\n\nals = ALS(userCol=\"user_id\", maxIter=5, regParam=0.01, itemCol=\"isbn\", ratingCol=\"rating\", coldStartStrategy=\"drop\")\npipeline = Pipeline(stages=[als])\nparamGrid = ParamGridBuilder().addGrid(als.rank, [10, ]).addGrid(als.regParam,[0.01]).build()\n\ncrossval = CrossValidator(estimator=pipeline, estimatorParamMaps=paramGrid, evaluator=RankingEvaluator(labelCol=\"rating\", predictionCol=\"prediction\", metricName=\"meanAveragePrecision\"),numFolds=4)\n\nals_cvModel = crossval.fit(training)","user":"anonymous","dateUpdated":"2023-05-10T18:22:41+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":" \n[Stage 34:>                                                         (0 + 1) / 1]\n\n                                                                                \n\n[Stage 35:>                 (0 + 1) / 1][Stage 36:>                 (0 + 1) / 1]\n\n[Stage 36:>                                                         (0 + 1) / 1]\n\n[Stage 37:>                                                         (0 + 0) / 1]\n23/05/10 17:59:33 WARN scheduler.DAGScheduler: Broadcasting large task binary with size 29.4 MiB\n\n[Stage 37:>                                                         (0 + 1) / 1]\n\n                                                                                \n\n[Stage 40:>                                                       (0 + 0) / 200]\n23/05/10 17:59:45 WARN scheduler.DAGScheduler: Broadcasting large task binary with size 29.4 MiB\n\n[Stage 40:>                                                       (0 + 4) / 200]\n\n[Stage 40:>                                                       (2 + 4) / 200]\n\n[Stage 40:=>                                                      (4 + 4) / 200]\n\n[Stage 40:=>                                                      (7 + 5) / 200]\n\n[Stage 40:==>                                                     (8 + 4) / 200]\n\n[Stage 40:==>                                                     (9 + 4) / 200]\n\n[Stage 40:==>                                                    (10 + 4) / 200]\n\n[Stage 40:===>                                                   (11 + 4) / 200]\n\n[Stage 40:===>                                                   (12 + 4) / 200]\n\n[Stage 40:===>                                                   (13 + 4) / 200]\n\n[Stage 40:===>                                                   (14 + 4) / 200]\n\n[Stage 40:====>                                                  (16 + 4) / 200]\n\n[Stage 40:====>                                                  (17 + 4) / 200]\n\n[Stage 40:====>                                                  (18 + 4) / 200]\n\n[Stage 40:=====>                                                 (19 + 4) / 200]\n\n[Stage 40:=====>                                                 (20 + 4) / 200]\n\n[Stage 40:=====>                                                 (20 + 5) / 200]\n\n[Stage 40:=====>                                                 (21 + 4) / 200]\n\n[Stage 40:======>                                                (22 + 4) / 200]\n\n[Stage 40:======>                                                (23 + 4) / 200]\n\n[Stage 40:======>                                                (24 + 4) / 200]\n\n[Stage 40:======>                                                (25 + 4) / 200]\n\n[Stage 40:=======>                                               (26 + 4) / 200]\n\n[Stage 40:=======>                                               (27 + 4) / 200]\n\n[Stage 40:=======>                                               (29 + 4) / 200]\n\n[Stage 40:========>                                              (30 + 4) / 200]\n\n[Stage 40:========>                                              (31 + 4) / 200]\n\n[Stage 40:========>                                              (32 + 4) / 200]\n\n[Stage 40:========>                                              (32 + 5) / 200]\n\n[Stage 40:=========>                                             (33 + 4) / 200]\n\n[Stage 40:=========>                                             (34 + 4) / 200]\n\n[Stage 40:=========>                                             (35 + 4) / 200]\n\n[Stage 40:=========>                                             (35 + 5) / 200]\n\n[Stage 40:==========>                                            (37 + 4) / 200]\n\n[Stage 40:==========>                                            (38 + 4) / 200]\n\n[Stage 40:==========>                                            (39 + 4) / 200]\n\n[Stage 40:===========>                                           (40 + 5) / 200]\n\n[Stage 40:===========>                                           (41 + 4) / 200]\n\n[Stage 40:===========>                                           (42 + 4) / 200]\n\n[Stage 40:===========>                                           (43 + 4) / 200]\n\n[Stage 40:============>                                          (45 + 4) / 200]\n\n[Stage 40:============>                                          (46 + 4) / 200]\n\n[Stage 40:============>                                          (46 + 5) / 200]\n\n[Stage 40:============>                                          (47 + 4) / 200]\n\n[Stage 40:=============>                                         (49 + 4) / 200]\n\n[Stage 40:==============>                                        (51 + 4) / 200]\n\n[Stage 40:==============>                                        (51 + 5) / 200]\n\n[Stage 40:==============>                                        (53 + 4) / 200]\n\n[Stage 40:==============>                                        (54 + 4) / 200]\n\n[Stage 40:===============>                                       (55 + 4) / 200]\n\n[Stage 40:===============>                                       (56 + 5) / 200]\n\n[Stage 40:===============>                                       (57 + 4) / 200]\n\n[Stage 40:===============>                                       (58 + 4) / 200]\n\n[Stage 40:================>                                      (59 + 4) / 200]\n\n[Stage 40:================>                                      (60 + 4) / 200]\n\n[Stage 40:================>                                      (61 + 4) / 200]\n\n[Stage 40:================>                                      (61 + 5) / 200]\n\n[Stage 40:=================>                                     (62 + 4) / 200]\n\n[Stage 40:=================>                                     (63 + 4) / 200]\n\n[Stage 40:=================>                                     (64 + 4) / 200]\n\n[Stage 40:=================>                                     (65 + 4) / 200]\n\n[Stage 40:=================>                                     (65 + 5) / 200]\n\n[Stage 40:==================>                                    (66 + 4) / 200]\n\n[Stage 40:==================>                                    (67 + 4) / 200]\n\n[Stage 40:==================>                                    (68 + 4) / 200]\n\n[Stage 40:==================>                                    (69 + 5) / 200]\n\n[Stage 40:===================>                                   (70 + 4) / 200]\n\n[Stage 40:===================>                                   (71 + 4) / 200]\n\n[Stage 40:===================>                                   (72 + 4) / 200]\n\n[Stage 40:====================>                                  (73 + 4) / 200]\n\n[Stage 40:====================>                                  (73 + 5) / 200]\n\n[Stage 40:====================>                                  (74 + 4) / 200]\n\n[Stage 40:====================>                                  (75 + 4) / 200]\n\n[Stage 40:====================>                                  (76 + 4) / 200]\n\n[Stage 40:=====================>                                 (77 + 4) / 200]\n\n[Stage 40:=====================>                                 (78 + 4) / 200]\n\n[Stage 40:=====================>                                 (79 + 4) / 200]\n\n[Stage 40:======================>                                (80 + 4) / 200]\n\n[Stage 40:======================>                                (81 + 4) / 200]\n\n[Stage 40:======================>                                (82 + 4) / 200]\n\n[Stage 40:======================>                                (83 + 4) / 200]\n\n[Stage 40:======================>                                (83 + 5) / 200]\n\n[Stage 40:=======================>                               (84 + 4) / 200]\n\n[Stage 40:=======================>                               (86 + 4) / 200]\n\n[Stage 40:=======================>                               (87 + 4) / 200]\n\n[Stage 40:========================>                              (88 + 4) / 200]\n\n[Stage 40:========================>                              (90 + 4) / 200]\n\n[Stage 40:=========================>                             (91 + 4) / 200]\n\n[Stage 40:=========================>                             (92 + 4) / 200]\n\n[Stage 40:=========================>                             (93 + 4) / 200]\n\n[Stage 40:=========================>                             (94 + 4) / 200]\n\n[Stage 40:==========================>                            (95 + 4) / 200]\n\n[Stage 40:==========================>                            (96 + 4) / 200]\n\n[Stage 40:==========================>                            (97 + 4) / 200]\n\n[Stage 40:==========================>                            (98 + 4) / 200]\n\n[Stage 40:===========================>                           (99 + 4) / 200]\n\n[Stage 40:===========================>                          (100 + 4) / 200]\n\n[Stage 40:===========================>                          (101 + 4) / 200]\n\n[Stage 40:===========================>                          (102 + 4) / 200]\n\n[Stage 40:===========================>                          (103 + 4) / 200]\n\n[Stage 40:============================>                         (104 + 4) / 200]\n\n[Stage 40:============================>                         (106 + 4) / 200]\n\n[Stage 40:============================>                         (107 + 4) / 200]\n\n[Stage 40:=============================>                        (109 + 4) / 200]\n\n[Stage 40:=============================>                        (110 + 4) / 200]\n\n[Stage 40:=============================>                        (111 + 4) / 200]\n\n[Stage 40:==============================>                       (112 + 4) / 200]\n\n[Stage 40:==============================>                       (113 + 4) / 200]\n\n[Stage 40:==============================>                       (114 + 4) / 200]\n\n[Stage 40:===============================>                      (115 + 4) / 200]\n\n[Stage 40:===============================>                      (116 + 4) / 200]\n\n[Stage 40:===============================>                      (116 + 5) / 200]\n\n[Stage 40:===============================>                      (117 + 4) / 200]\n\n[Stage 40:===============================>                      (118 + 4) / 200]\n\n[Stage 40:================================>                     (119 + 4) / 200]\n\n[Stage 40:================================>                     (120 + 4) / 200]\n\n[Stage 40:================================>                     (120 + 5) / 200]\n\n[Stage 40:================================>                     (121 + 4) / 200]\n\n[Stage 40:================================>                     (122 + 4) / 200]\n\n[Stage 40:=================================>                    (123 + 4) / 200]\n\n[Stage 40:=================================>                    (124 + 4) / 200]\n\n[Stage 40:=================================>                    (125 + 4) / 200]\n\n[Stage 40:=================================>                    (125 + 5) / 200]\n\n[Stage 40:==================================>                   (126 + 4) / 200]\n\n[Stage 40:==================================>                   (127 + 4) / 200]\n\n[Stage 40:==================================>                   (128 + 4) / 200]\n\n[Stage 40:==================================>                   (129 + 4) / 200]\n\n[Stage 40:===================================>                  (130 + 4) / 200]\n\n[Stage 40:===================================>                  (132 + 4) / 200]\n\n[Stage 40:===================================>                  (133 + 4) / 200]\n\n[Stage 40:====================================>                 (134 + 4) / 200]\n\n[Stage 40:====================================>                 (135 + 4) / 200]\n\n[Stage 40:====================================>                 (135 + 5) / 200]\n\n[Stage 40:====================================>                 (136 + 4) / 200]\n\n[Stage 40:====================================>                 (137 + 4) / 200]\n\n[Stage 40:=====================================>                (138 + 4) / 200]\n\n[Stage 40:=====================================>                (139 + 4) / 200]\n\n[Stage 40:=====================================>                (140 + 5) / 200]\n\n[Stage 40:======================================>               (141 + 4) / 200]\n\n[Stage 40:======================================>               (143 + 4) / 200]\n\n[Stage 40:======================================>               (144 + 4) / 200]\n\n[Stage 40:=======================================>              (145 + 4) / 200]\n\n[Stage 40:=======================================>              (146 + 4) / 200]\n\n[Stage 40:=======================================>              (147 + 4) / 200]\n\n[Stage 40:========================================>             (149 + 4) / 200]\n\n[Stage 40:========================================>             (151 + 4) / 200]\n\n[Stage 40:========================================>             (151 + 5) / 200]\n\n[Stage 40:=========================================>            (153 + 4) / 200]\n\n[Stage 40:=========================================>            (155 + 4) / 200]\n\n[Stage 40:==========================================>           (157 + 4) / 200]\n\n[Stage 40:==========================================>           (159 + 4) / 200]\n\n[Stage 40:===========================================>          (161 + 4) / 200]\n\n[Stage 40:===========================================>          (162 + 4) / 200]\n\n[Stage 40:============================================>         (163 + 4) / 200]\n\n[Stage 40:============================================>         (164 + 4) / 200]\n\n[Stage 40:============================================>         (165 + 4) / 200]\n\n[Stage 40:============================================>         (165 + 5) / 200]\n\n[Stage 40:============================================>         (166 + 5) / 200]\n\n[Stage 40:=============================================>        (167 + 4) / 200]\n\n[Stage 40:=============================================>        (167 + 5) / 200]\n\n[Stage 40:=============================================>        (168 + 5) / 200]\n\n[Stage 40:=============================================>        (169 + 4) / 200]\n\n[Stage 40:=============================================>        (170 + 4) / 200]\n\n[Stage 40:==============================================>       (171 + 4) / 200]\n\n[Stage 40:==============================================>       (172 + 4) / 200]\n\n[Stage 40:==============================================>       (173 + 4) / 200]\n\n[Stage 40:==============================================>       (174 + 4) / 200]\n\n[Stage 40:===============================================>      (175 + 4) / 200]\n\n[Stage 40:===============================================>      (176 + 4) / 200]\n\n[Stage 40:===============================================>      (177 + 4) / 200]\n\n[Stage 40:================================================>     (178 + 4) / 200]\n\n[Stage 40:================================================>     (179 + 4) / 200]\n\n[Stage 40:================================================>     (180 + 4) / 200]\n\n[Stage 40:================================================>     (180 + 5) / 200]\n\n[Stage 40:================================================>     (181 + 4) / 200]\n\n[Stage 40:=================================================>    (182 + 4) / 200]\n\n[Stage 40:=================================================>    (183 + 4) / 200]\n\n[Stage 40:=================================================>    (183 + 5) / 200]\n\n[Stage 40:=================================================>    (185 + 4) / 200]\n\n[Stage 40:==================================================>   (186 + 4) / 200]\n\n[Stage 40:==================================================>   (187 + 4) / 200]\n\n[Stage 40:==================================================>   (187 + 5) / 200]\n\n[Stage 40:===================================================>  (189 + 4) / 200]\n\n[Stage 40:===================================================>  (190 + 4) / 200]\n\n[Stage 40:===================================================>  (191 + 4) / 200]\n\n[Stage 40:===================================================>  (192 + 4) / 200]\n\n[Stage 40:====================================================> (193 + 4) / 200]\n\n[Stage 40:====================================================> (194 + 4) / 200]\n\n[Stage 40:====================================================> (195 + 4) / 200]\n\n[Stage 40:=====================================================>(198 + 2) / 200]\n\n[Stage 40:=====================================================>(199 + 1) / 200]\n\n[Stage 41:>                                                       (0 + 0) / 200]\n23/05/10 18:05:41 WARN scheduler.DAGScheduler: Broadcasting large task binary with size 29.4 MiB\n\n[Stage 41:>                                                       (0 + 4) / 200]\n\n[Stage 41:>                                                       (2 + 5) / 200]\n\n[Stage 41:=>                                                      (4 + 4) / 200]\n\n[Stage 41:=>                                                      (5 + 4) / 200]\n\n[Stage 41:=>                                                      (6 + 4) / 200]\n\n[Stage 41:==>                                                     (8 + 4) / 200]\n\n[Stage 41:==>                                                     (9 + 4) / 200]\n\n[Stage 41:==>                                                    (10 + 4) / 200]\n\n[Stage 41:===>                                                   (11 + 5) / 200]\n\n[Stage 41:===>                                                   (12 + 4) / 200]\n\n[Stage 41:===>                                                   (12 + 5) / 200]\n\n[Stage 41:===>                                                   (13 + 4) / 200]\n\n[Stage 41:===>                                                   (14 + 4) / 200]\n\n[Stage 41:====>                                                  (16 + 4) / 200]\n\n[Stage 41:====>                                                  (17 + 4) / 200]\n\n[Stage 41:====>                                                  (17 + 5) / 200]\n\n[Stage 41:====>                                                  (18 + 4) / 200]\n\n[Stage 41:=====>                                                 (20 + 4) / 200]\n\n[Stage 41:=====>                                                 (21 + 4) / 200]\n\n[Stage 41:======>                                                (22 + 4) / 200]\n\n[Stage 41:======>                                                (23 + 4) / 200]\n\n[Stage 41:======>                                                (24 + 4) / 200]\n\n[Stage 41:======>                                                (24 + 5) / 200]\n\n[Stage 41:======>                                                (25 + 4) / 200]\n\n[Stage 41:=======>                                               (26 + 4) / 200]\n\n[Stage 41:=======>                                               (28 + 4) / 200]\n\n[Stage 41:=======>                                               (29 + 4) / 200]\n\n[Stage 41:========>                                              (30 + 4) / 200]\n\n[Stage 41:========>                                              (31 + 4) / 200]\n\n[Stage 41:========>                                              (32 + 4) / 200]\n\n[Stage 41:=========>                                             (33 + 4) / 200]\n\n[Stage 41:=========>                                             (34 + 4) / 200]\n\n[Stage 41:=========>                                             (35 + 4) / 200]\n\n[Stage 41:==========>                                            (37 + 4) / 200]\n\n[Stage 41:===========>                                           (40 + 4) / 200]\n\n[Stage 41:===========>                                           (41 + 4) / 200]\n\n[Stage 41:===========>                                           (41 + 5) / 200]\n\n[Stage 41:===========>                                           (42 + 4) / 200]\n\n[Stage 41:============>                                          (44 + 4) / 200]\n\n[Stage 41:============>                                          (45 + 4) / 200]\n\n[Stage 41:============>                                          (46 + 4) / 200]\n\n[Stage 41:============>                                          (46 + 5) / 200]\n\n[Stage 41:============>                                          (47 + 4) / 200]\n\n[Stage 41:=============>                                         (48 + 4) / 200]\n\n[Stage 41:=============>                                         (48 + 5) / 200]\n\n[Stage 41:=============>                                         (49 + 4) / 200]\n\n[Stage 41:=============>                                         (50 + 4) / 200]\n\n[Stage 41:==============>                                        (51 + 4) / 200]\n\n[Stage 41:==============>                                        (52 + 4) / 200]\n\n[Stage 41:==============>                                        (52 + 5) / 200]\n\n[Stage 41:==============>                                        (53 + 4) / 200]\n\n[Stage 41:==============>                                        (54 + 4) / 200]\n\n[Stage 41:===============>                                       (55 + 4) / 200]\n\n[Stage 41:===============>                                       (57 + 4) / 200]\n\n[Stage 41:===============>                                       (57 + 5) / 200]\n\n[Stage 41:===============>                                       (58 + 4) / 200]\n\n[Stage 41:================>                                      (59 + 4) / 200]\n\n[Stage 41:================>                                      (60 + 4) / 200]\n\n[Stage 41:================>                                      (61 + 4) / 200]\n\n[Stage 41:=================>                                     (62 + 4) / 200]\n\n[Stage 41:=================>                                     (64 + 4) / 200]\n\n[Stage 41:=================>                                     (65 + 4) / 200]\n\n[Stage 41:==================>                                    (66 + 4) / 200]\n\n[Stage 41:==================>                                    (67 + 4) / 200]\n\n[Stage 41:==================>                                    (69 + 4) / 200]\n\n[Stage 41:===================>                                   (70 + 4) / 200]\n\n[Stage 41:===================>                                   (71 + 4) / 200]\n\n[Stage 41:====================>                                  (73 + 4) / 200]\n\n[Stage 41:====================>                                  (73 + 5) / 200]\n\n[Stage 41:====================>                                  (76 + 4) / 200]\n\n[Stage 41:=====================>                                 (77 + 4) / 200]\n\n[Stage 41:=====================>                                 (77 + 6) / 200]\n\n[Stage 41:=====================>                                 (79 + 4) / 200]\n\n[Stage 41:======================>                                (81 + 4) / 200]\n\n[Stage 41:======================>                                (82 + 5) / 200]\n\n[Stage 41:=======================>                               (84 + 4) / 200]\n\n[Stage 41:=======================>                               (85 + 4) / 200]\n\n[Stage 41:=======================>                               (86 + 4) / 200]\n\n[Stage 41:========================>                              (89 + 4) / 200]\n\n[Stage 41:========================>                              (90 + 4) / 200]\n\n[Stage 41:========================>                              (90 + 5) / 200]\n\n[Stage 41:=========================>                             (92 + 4) / 200]\n\n[Stage 41:=========================>                             (93 + 4) / 200]\n\n[Stage 41:=========================>                             (93 + 5) / 200]\n\n[Stage 41:=========================>                             (94 + 4) / 200]\n\n[Stage 41:==========================>                            (95 + 4) / 200]\n\n[Stage 41:==========================>                            (97 + 4) / 200]\n\n[Stage 41:===========================>                           (99 + 4) / 200]\n\n[Stage 41:===========================>                          (101 + 4) / 200]\n\n[Stage 41:===========================>                          (101 + 5) / 200]\n\n[Stage 41:===========================>                          (102 + 4) / 200]\n\n[Stage 41:============================>                         (105 + 4) / 200]\n\n[Stage 41:============================>                         (106 + 5) / 200]\n\n[Stage 41:============================>                         (107 + 4) / 200]\n\n[Stage 41:=============================>                        (109 + 4) / 200]\n\n[Stage 41:==============================>                       (112 + 4) / 200]\n\n[Stage 41:==============================>                       (113 + 4) / 200]\n\n[Stage 41:==============================>                       (114 + 4) / 200]\n\n[Stage 41:==============================>                       (114 + 5) / 200]\n\n[Stage 41:===============================>                      (116 + 4) / 200]\n\n[Stage 41:===============================>                      (117 + 4) / 200]\n\n[Stage 41:===============================>                      (118 + 4) / 200]\n\n[Stage 41:================================>                     (120 + 4) / 200]\n\n[Stage 41:================================>                     (121 + 4) / 200]\n\n[Stage 41:================================>                     (122 + 4) / 200]\n\n[Stage 41:=================================>                    (123 + 4) / 200]\n\n[Stage 41:=================================>                    (124 + 4) / 200]\n\n[Stage 41:=================================>                    (125 + 4) / 200]\n\n[Stage 41:==================================>                   (126 + 4) / 200]\n\n[Stage 41:==================================>                   (128 + 4) / 200]\n\n[Stage 41:==================================>                   (129 + 4) / 200]\n\n[Stage 41:===================================>                  (131 + 4) / 200]\n\n[Stage 41:===================================>                  (132 + 4) / 200]\n\n[Stage 41:===================================>                  (133 + 4) / 200]\n\n[Stage 41:====================================>                 (134 + 4) / 200]\n\n[Stage 41:====================================>                 (136 + 4) / 200]\n\n[Stage 41:====================================>                 (136 + 5) / 200]\n\n[Stage 41:=====================================>                (138 + 4) / 200]\n\n[Stage 41:=====================================>                (139 + 5) / 200]\n\n[Stage 41:=====================================>                (140 + 4) / 200]\n\n[Stage 41:======================================>               (142 + 4) / 200]\n\n[Stage 41:======================================>               (143 + 5) / 200]\n\n[Stage 41:======================================>               (144 + 4) / 200]\n\n[Stage 41:=======================================>              (145 + 4) / 200]\n\n[Stage 41:=======================================>              (147 + 4) / 200]\n\n[Stage 41:=======================================>              (148 + 4) / 200]\n\n[Stage 41:========================================>             (149 + 5) / 200]\n\n[Stage 41:=========================================>            (152 + 4) / 200]\n\n[Stage 41:=========================================>            (153 + 4) / 200]\n\n[Stage 41:=========================================>            (154 + 4) / 200]\n\n[Stage 41:=========================================>            (155 + 5) / 200]\n\n[Stage 41:==========================================>           (156 + 4) / 200]\n\n[Stage 41:==========================================>           (157 + 4) / 200]\n\n[Stage 41:==========================================>           (159 + 4) / 200]\n\n[Stage 41:==========================================>           (159 + 5) / 200]\n\n[Stage 41:===========================================>          (160 + 4) / 200]\n\n[Stage 41:===========================================>          (161 + 4) / 200]\n\n[Stage 41:============================================>         (163 + 4) / 200]\n\n[Stage 41:============================================>         (164 + 4) / 200]\n\n[Stage 41:============================================>         (165 + 4) / 200]\n\n[Stage 41:=============================================>        (168 + 4) / 200]\n\n[Stage 41:=============================================>        (169 + 4) / 200]\n\n[Stage 41:==============================================>       (171 + 4) / 200]\n\n[Stage 41:==============================================>       (172 + 4) / 200]\n\n[Stage 41:==============================================>       (173 + 5) / 200]\n\n[Stage 41:===============================================>      (175 + 4) / 200]\n\n[Stage 41:===============================================>      (176 + 4) / 200]\n\n[Stage 41:===============================================>      (176 + 5) / 200]\n\n[Stage 41:===============================================>      (177 + 4) / 200]\n\n[Stage 41:================================================>     (178 + 4) / 200]\n\n[Stage 41:================================================>     (179 + 4) / 200]\n\n[Stage 41:================================================>     (180 + 4) / 200]\n\n[Stage 41:=================================================>    (182 + 4) / 200]\n\n[Stage 41:=================================================>    (183 + 4) / 200]\n\n[Stage 41:=================================================>    (184 + 4) / 200]\n\n[Stage 41:==================================================>   (186 + 5) / 200]\n\n[Stage 41:==================================================>   (187 + 4) / 200]\n\n[Stage 41:==================================================>   (188 + 4) / 200]\n\n[Stage 41:===================================================>  (189 + 5) / 200]\n\n[Stage 41:===================================================>  (191 + 4) / 200]\n\n[Stage 41:===================================================>  (191 + 5) / 200]\n\n[Stage 41:===================================================>  (192 + 4) / 200]\n\n[Stage 41:====================================================> (195 + 4) / 200]\n\n[Stage 41:=====================================================>(198 + 2) / 200]\n\n[Stage 41:=====================================================>(199 + 1) / 200]\n\n[Stage 42:>                                                        (0 + 0) / 10]\n23/05/10 18:12:13 WARN scheduler.DAGScheduler: Broadcasting large task binary with size 29.4 MiB\n\n[Stage 42:>                                                        (0 + 4) / 10]\n\n[Stage 42:=====>                                                   (1 + 4) / 10]\n\n[Stage 42:=================>                                       (3 + 4) / 10]\n\n[Stage 42:======================>                                  (4 + 4) / 10]\n\n[Stage 42:======================>                                  (4 + 5) / 10]\n\n[Stage 42:==================================>                      (6 + 4) / 10]\n\n[Stage 42:=============================================>           (8 + 2) / 10]\n\n[Stage 42:===================================================>     (9 + 1) / 10]\n\n                                                                                \n23/05/10 18:12:33 WARN scheduler.DAGScheduler: Broadcasting large task binary with size 29.4 MiB\n\n[Stage 46:>                                                       (0 + 0) / 200]\n\n[Stage 46:>                                                       (0 + 4) / 200]\n\n[Stage 46:>                                                       (2 + 5) / 200]\n\n[Stage 46:=>                                                      (4 + 4) / 200]\n\n[Stage 46:=>                                                      (6 + 4) / 200]\n\n[Stage 46:=>                                                      (7 + 5) / 200]\n\n[Stage 46:==>                                                     (8 + 4) / 200]\n\n[Stage 46:==>                                                     (9 + 4) / 200]\n\n[Stage 46:===>                                                   (12 + 4) / 200]\n\n[Stage 46:===>                                                   (13 + 4) / 200]\n\n[Stage 46:===>                                                   (14 + 5) / 200]\n\n[Stage 46:====>                                                  (15 + 4) / 200]\n\n[Stage 46:====>                                                  (16 + 4) / 200]\n\n[Stage 46:====>                                                  (17 + 4) / 200]\n\n[Stage 46:=====>                                                 (19 + 4) / 200]\n\n[Stage 46:=====>                                                 (19 + 5) / 200]\n\n[Stage 46:=====>                                                 (20 + 4) / 200]\n\n[Stage 46:=====>                                                 (21 + 4) / 200]\n\n[Stage 46:======>                                                (22 + 4) / 200]\n\n[Stage 46:======>                                                (23 + 4) / 200]\n\n[Stage 46:======>                                                (24 + 4) / 200]\n\n[Stage 46:======>                                                (25 + 5) / 200]\n\n[Stage 46:=======>                                               (26 + 4) / 200]\n\n[Stage 46:=======>                                               (28 + 4) / 200]\n\n[Stage 46:========>                                              (30 + 4) / 200]\n\n[Stage 46:========>                                              (32 + 4) / 200]\n\n[Stage 46:=========>                                             (33 + 4) / 200]\n\n[Stage 46:=========>                                             (34 + 4) / 200]\n\n[Stage 46:=========>                                             (34 + 5) / 200]\n\n[Stage 46:=========>                                             (36 + 4) / 200]\n\n[Stage 46:==========>                                            (37 + 4) / 200]\n\n[Stage 46:==========>                                            (38 + 4) / 200]\n\n[Stage 46:===========>                                           (41 + 4) / 200]\n\n[Stage 46:===========>                                           (42 + 4) / 200]\n\n[Stage 46:===========>                                           (42 + 5) / 200]\n\n[Stage 46:============>                                          (44 + 4) / 200]\n\n[Stage 46:============>                                          (45 + 4) / 200]\n\n[Stage 46:============>                                          (45 + 5) / 200]\n\n[Stage 46:============>                                          (46 + 4) / 200]\n\n[Stage 46:============>                                          (47 + 4) / 200]\n\n[Stage 46:=============>                                         (48 + 4) / 200]\n\n[Stage 46:=============>                                         (49 + 4) / 200]\n\n[Stage 46:=============>                                         (50 + 4) / 200]\n\n[Stage 46:==============>                                        (51 + 4) / 200]\n\n[Stage 46:==============>                                        (52 + 4) / 200]\n\n[Stage 46:===============>                                       (55 + 4) / 200]\n\n[Stage 46:===============>                                       (56 + 4) / 200]\n\n[Stage 46:===============>                                       (57 + 4) / 200]\n\n[Stage 46:================>                                      (59 + 4) / 200]\n\n[Stage 46:================>                                      (60 + 4) / 200]\n\n[Stage 46:================>                                      (61 + 4) / 200]\n\n[Stage 46:=================>                                     (62 + 4) / 200]\n\n[Stage 46:=================>                                     (63 + 4) / 200]\n\n[Stage 46:=================>                                     (64 + 4) / 200]\n\n[Stage 46:=================>                                     (65 + 4) / 200]\n\n[Stage 46:==================>                                    (66 + 4) / 200]\n\n[Stage 46:==================>                                    (67 + 4) / 200]\n\n[Stage 46:==================>                                    (67 + 5) / 200]\n\n[Stage 46:==================>                                    (69 + 4) / 200]\n\n[Stage 46:===================>                                   (70 + 4) / 200]\n\n[Stage 46:===================>                                   (71 + 5) / 200]\n\n[Stage 46:===================>                                   (72 + 4) / 200]\n\n[Stage 46:====================>                                  (74 + 4) / 200]\n\n[Stage 46:====================>                                  (75 + 5) / 200]\n\n[Stage 46:====================>                                  (76 + 4) / 200]\n\n[Stage 46:=====================>                                 (77 + 4) / 200]\n\n[Stage 46:=====================>                                 (78 + 4) / 200]\n\n[Stage 46:======================>                                (80 + 4) / 200]\n\n[Stage 46:======================>                                (81 + 4) / 200]\n\n[Stage 46:======================>                                (82 + 4) / 200]\n\n[Stage 46:=======================>                               (84 + 4) / 200]\n\n[Stage 46:=======================>                               (85 + 4) / 200]\n\n[Stage 46:=======================>                               (86 + 4) / 200]\n\n[Stage 46:========================>                              (88 + 4) / 200]\n\n[Stage 46:========================>                              (89 + 4) / 200]\n\n[Stage 46:========================>                              (90 + 4) / 200]\n\n[Stage 46:========================>                              (90 + 5) / 200]\n\n[Stage 46:=========================>                             (91 + 4) / 200]\n\n[Stage 46:=========================>                             (92 + 4) / 200]\n\n[Stage 46:=========================>                             (93 + 4) / 200]\n\n[Stage 46:=========================>                             (93 + 5) / 200]\n\n[Stage 46:=========================>                             (94 + 4) / 200]\n\n[Stage 46:==========================>                            (95 + 5) / 200]\n\n[Stage 46:==========================>                            (96 + 4) / 200]\n\n[Stage 46:==========================>                            (96 + 5) / 200]\n\n[Stage 46:==========================>                            (98 + 4) / 200]\n\n[Stage 46:===========================>                           (99 + 4) / 200]\n\n[Stage 46:===========================>                          (100 + 4) / 200]\n\n[Stage 46:===========================>                          (100 + 5) / 200]\n\n[Stage 46:===========================>                          (102 + 4) / 200]\n\n[Stage 46:===========================>                          (103 + 4) / 200]\n\n[Stage 46:============================>                         (104 + 4) / 200]\n\n[Stage 46:============================>                         (104 + 5) / 200]\n\n[Stage 46:============================>                         (105 + 4) / 200]\n\n[Stage 46:============================>                         (106 + 4) / 200]\n\n[Stage 46:============================>                         (107 + 4) / 200]\n\n[Stage 46:============================>                         (107 + 5) / 200]\n\n[Stage 46:=============================>                        (108 + 4) / 200]\n\n[Stage 46:=============================>                        (110 + 4) / 200]\n\n[Stage 46:=============================>                        (111 + 4) / 200]\n\n[Stage 46:==============================>                       (112 + 4) / 200]\n\n[Stage 46:==============================>                       (114 + 5) / 200]\n\n[Stage 46:===============================>                      (115 + 4) / 200]\n\n[Stage 46:===============================>                      (116 + 4) / 200]\n\n[Stage 46:===============================>                      (118 + 4) / 200]\n\n[Stage 46:================================>                     (119 + 5) / 200]\n\n[Stage 46:================================>                     (120 + 4) / 200]\n\n[Stage 46:================================>                     (121 + 5) / 200]\n\n[Stage 46:=================================>                    (124 + 4) / 200]\n\n[Stage 46:=================================>                    (125 + 4) / 200]\n\n[Stage 46:==================================>                   (127 + 4) / 200]\n\n[Stage 46:==================================>                   (128 + 4) / 200]\n\n[Stage 46:==================================>                   (129 + 4) / 200]\n\n[Stage 46:===================================>                  (131 + 4) / 200]\n\n[Stage 46:===================================>                  (132 + 4) / 200]\n\n[Stage 46:===================================>                  (133 + 4) / 200]\n\n[Stage 46:====================================>                 (134 + 4) / 200]\n\n[Stage 46:====================================>                 (136 + 4) / 200]\n\n[Stage 46:=====================================>                (138 + 5) / 200]\n\n[Stage 46:=====================================>                (139 + 4) / 200]\n\n[Stage 46:======================================>               (143 + 4) / 200]\n\n[Stage 46:======================================>               (144 + 4) / 200]\n\n[Stage 46:=======================================>              (146 + 5) / 200]\n\n[Stage 46:=======================================>              (147 + 4) / 200]\n\n[Stage 46:========================================>             (149 + 4) / 200]\n\n[Stage 46:========================================>             (150 + 4) / 200]\n\n[Stage 46:========================================>             (151 + 4) / 200]\n\n[Stage 46:=========================================>            (152 + 4) / 200]\n\n[Stage 46:=========================================>            (152 + 5) / 200]\n\n[Stage 46:=========================================>            (153 + 4) / 200]\n\n[Stage 46:=========================================>            (154 + 4) / 200]\n\n[Stage 46:=========================================>            (155 + 4) / 200]\n\n[Stage 46:==========================================>           (157 + 4) / 200]\n\n[Stage 46:==========================================>           (158 + 4) / 200]\n\n[Stage 46:==========================================>           (159 + 4) / 200]\n\n[Stage 46:===========================================>          (160 + 4) / 200]\n\n[Stage 46:===========================================>          (162 + 4) / 200]\n\n[Stage 46:============================================>         (163 + 4) / 200]\n\n[Stage 46:============================================>         (165 + 4) / 200]\n\n[Stage 46:============================================>         (166 + 4) / 200]\n\n[Stage 46:=============================================>        (167 + 4) / 200]\n\n[Stage 46:=============================================>        (168 + 4) / 200]\n\n[Stage 46:=============================================>        (169 + 4) / 200]\n\n[Stage 46:=============================================>        (170 + 4) / 200]\n\n[Stage 46:==============================================>       (171 + 4) / 200]\n\n[Stage 46:==============================================>       (172 + 4) / 200]\n\n[Stage 46:==============================================>       (173 + 4) / 200]\n\n[Stage 46:==============================================>       (174 + 4) / 200]\n\n[Stage 46:===============================================>      (175 + 5) / 200]\n\n[Stage 46:===============================================>      (176 + 4) / 200]\n\n[Stage 46:===============================================>      (177 + 4) / 200]\n\n[Stage 46:================================================>     (178 + 4) / 200]\n\n[Stage 46:================================================>     (179 + 4) / 200]\n\n[Stage 46:================================================>     (180 + 4) / 200]\n\n[Stage 46:================================================>     (181 + 5) / 200]\n\n[Stage 46:=================================================>    (183 + 4) / 200]\n\n[Stage 46:=================================================>    (184 + 4) / 200]\n\n[Stage 46:==================================================>   (186 + 4) / 200]\n\n[Stage 46:==================================================>   (187 + 4) / 200]\n\n[Stage 46:===================================================>  (190 + 4) / 200]\n\n[Stage 46:===================================================>  (191 + 4) / 200]\n\n[Stage 46:====================================================> (193 + 4) / 200]\n\n[Stage 46:====================================================> (195 + 4) / 200]\n\n[Stage 46:====================================================> (196 + 4) / 200]\n\n[Stage 46:=====================================================>(199 + 1) / 200]\n23/05/10 18:17:53 WARN scheduler.DAGScheduler: Broadcasting large task binary with size 29.4 MiB\n\n[Stage 47:>                                                        (0 + 0) / 10]\n\n[Stage 47:>                                                        (0 + 4) / 10]\n\n[Stage 47:===========>                                             (2 + 4) / 10]\n\n[Stage 47:=================>                                       (3 + 4) / 10]\n\n[Stage 47:=================>                                       (3 + 5) / 10]\n\n[Stage 47:======================>                                  (4 + 4) / 10]\n\n[Stage 47:============================>                            (5 + 4) / 10]\n\n[Stage 47:==================================>                      (6 + 4) / 10]\n\n[Stage 47:=======================================>                 (7 + 3) / 10]\n\n[Stage 47:=============================================>           (8 + 2) / 10]\n\n                                                                                \n23/05/10 18:18:16 WARN scheduler.DAGScheduler: Broadcasting large task binary with size 29.4 MiB\n\n[Stage 52:>                                                        (0 + 0) / 10]\n\n[Stage 52:>                                                        (0 + 4) / 10]\n23/05/10 18:18:22 WARN netlib.BLAS: Failed to load implementation from: com.github.fommil.netlib.NativeSystemBLAS\n23/05/10 18:18:22 WARN netlib.BLAS: Failed to load implementation from: com.github.fommil.netlib.NativeRefBLAS\n\n[Stage 52:=====>                                                   (1 + 4) / 10]\n\n[Stage 52:=================>                                       (3 + 4) / 10]\n\n[Stage 52:=================>                                       (3 + 5) / 10]\n\n[Stage 52:======================>                                  (4 + 4) / 10]\n\n[Stage 52:==================================>                      (6 + 4) / 10]\n\n[Stage 52:=======================================>                 (7 + 3) / 10]\n\n[Stage 52:=============================================>           (8 + 2) / 10]\n23/05/10 18:18:31 WARN scheduler.DAGScheduler: Broadcasting large task binary with size 29.4 MiB\n\n[Stage 54:>                                                        (0 + 0) / 10]\n\n[Stage 54:>                                                        (0 + 2) / 10]\n\n[Stage 54:>                                                        (0 + 4) / 10]\n23/05/10 18:18:37 WARN netlib.LAPACK: Failed to load implementation from: com.github.fommil.netlib.NativeSystemLAPACK\n23/05/10 18:18:37 WARN netlib.LAPACK: Failed to load implementation from: com.github.fommil.netlib.NativeRefLAPACK\n\n[Stage 54:=====>                                                   (1 + 4) / 10]\n\n[Stage 54:======================>                                  (4 + 4) / 10]\n\n[Stage 54:=======================================>                 (7 + 3) / 10]\n\n[Stage 54:=============================================>           (8 + 2) / 10]\n\n[Stage 55:>                                                        (0 + 0) / 10]\n23/05/10 18:18:47 WARN scheduler.DAGScheduler: Broadcasting large task binary with size 29.4 MiB\n\n[Stage 55:>                                                        (0 + 4) / 10]\n\n[Stage 55:=====>                                                   (1 + 5) / 10]\n\n[Stage 55:=================>                                       (3 + 4) / 10]\n\n[Stage 55:======================>                                  (4 + 4) / 10]\n\n[Stage 55:============================>                            (5 + 4) / 10]\n\n[Stage 55:==================================>                      (6 + 4) / 10]\n\n[Stage 55:=============================================>           (8 + 2) / 10]\n\n[Stage 55:===================================================>     (9 + 1) / 10]\n23/05/10 18:19:04 WARN scheduler.DAGScheduler: Broadcasting large task binary with size 29.4 MiB\n\n[Stage 56:>                                                        (0 + 0) / 10]\n\n[Stage 56:>                                                        (0 + 4) / 10]\n\n[Stage 56:=====>                                                   (1 + 4) / 10]\n\n[Stage 56:===========>                                             (2 + 4) / 10]\n\n[Stage 56:=================>                                       (3 + 4) / 10]\n\n[Stage 56:======================>                                  (4 + 4) / 10]\n\n[Stage 56:============================>                            (5 + 4) / 10]\n\n[Stage 56:=======================================>                 (7 + 3) / 10]\n\n[Stage 56:=============================================>           (8 + 2) / 10]\n\n[Stage 56:===================================================>     (9 + 1) / 10]\n23/05/10 18:19:17 WARN scheduler.DAGScheduler: Broadcasting large task binary with size 29.4 MiB\n\n[Stage 57:>                                                        (0 + 0) / 10]\n\n[Stage 57:>                                                        (0 + 4) / 10]\n\n[Stage 57:===========>                                             (2 + 4) / 10]\n\n[Stage 57:======================>                                  (4 + 4) / 10]\n\n[Stage 57:=======================================>                 (7 + 3) / 10]\n\n[Stage 57:=============================================>           (8 + 2) / 10]\n\n[Stage 58:>                                                        (0 + 0) / 10]\n23/05/10 18:19:33 WARN scheduler.DAGScheduler: Broadcasting large task binary with size 29.4 MiB\n\n[Stage 58:>                                                        (0 + 4) / 10]\n\n[Stage 58:===========>                                             (2 + 4) / 10]\n\n[Stage 58:======================>                                  (4 + 4) / 10]\n\n[Stage 58:==================================>                      (6 + 4) / 10]\n\n[Stage 58:=======================================>                 (7 + 3) / 10]\n\n[Stage 58:=============================================>           (8 + 2) / 10]\n\n[Stage 58:===================================================>     (9 + 1) / 10]\n\n[Stage 59:>                                                        (0 + 0) / 10]\n23/05/10 18:19:52 WARN scheduler.DAGScheduler: Broadcasting large task binary with size 29.4 MiB\n\n[Stage 59:>                                                        (0 + 4) / 10]\n\n[Stage 59:=================>                                       (3 + 4) / 10]\n\n[Stage 59:======================>                                  (4 + 4) / 10]\n\n[Stage 59:============================>                            (5 + 4) / 10]\n\n[Stage 59:=======================================>                 (7 + 3) / 10]\n\n[Stage 59:=============================================>           (8 + 2) / 10]\n\n[Stage 59:===================================================>     (9 + 1) / 10]\n\n[Stage 60:>                                                        (0 + 0) / 10]\n23/05/10 18:20:12 WARN scheduler.DAGScheduler: Broadcasting large task binary with size 29.4 MiB\n\n[Stage 60:>                                                        (0 + 4) / 10]\n\n[Stage 60:===========>                                             (2 + 4) / 10]\n\n[Stage 60:=================>                                       (3 + 4) / 10]\n\n[Stage 60:======================>                                  (4 + 4) / 10]\n\n[Stage 60:==================================>                      (6 + 4) / 10]\n\n[Stage 60:=============================================>           (8 + 2) / 10]\n\n[Stage 60:===================================================>     (9 + 1) / 10]\n\n[Stage 61:>                                                        (0 + 0) / 10]\n23/05/10 18:20:33 WARN scheduler.DAGScheduler: Broadcasting large task binary with size 29.4 MiB\n\n[Stage 61:>                                                        (0 + 2) / 10]\n\n[Stage 61:>                                                        (0 + 4) / 10]\n\n[Stage 61:=================>                                       (3 + 5) / 10]\n\n[Stage 61:======================>                                  (4 + 4) / 10]\n\n[Stage 61:=============================================>           (8 + 2) / 10]\n\n[Stage 62:>                                                        (0 + 0) / 10]\n23/05/10 18:20:44 WARN scheduler.DAGScheduler: Broadcasting large task binary with size 29.4 MiB\n\n[Stage 62:>                                                        (0 + 4) / 10]\n\n[Stage 62:======================>                                  (4 + 4) / 10]\n\n[Stage 62:============================>                            (5 + 4) / 10]\n\n[Stage 62:=======================================>                 (7 + 3) / 10]\n\n[Stage 62:=============================================>           (8 + 2) / 10]\n23/05/10 18:20:58 WARN scheduler.DAGScheduler: Broadcasting large task binary with size 29.4 MiB\n\n[Stage 63:>                                                        (0 + 0) / 10]\n\n[Stage 63:>                                                        (0 + 4) / 10]\n\n[Stage 63:=================>                                       (3 + 4) / 10]\n\n[Stage 63:======================>                                  (4 + 4) / 10]\n\n[Stage 63:============================>                            (5 + 4) / 10]\n\n[Stage 63:=============================================>           (8 + 2) / 10]\n\n                                                                                \n\n[Stage 78:>                                                        (0 + 0) / 10]\n23/05/10 18:21:14 WARN scheduler.DAGScheduler: Broadcasting large task binary with size 29.4 MiB\n\n[Stage 78:>                                                        (0 + 4) / 10]\n\n[Stage 78:=================>                                       (3 + 4) / 10]\n\n[Stage 78:======================>                                  (4 + 4) / 10]\n\n[Stage 78:============================>                            (5 + 4) / 10]\n\n[Stage 78:==================================>                      (6 + 4) / 10]\n\n[Stage 78:===================================================>     (9 + 1) / 10]\n\n                                                                                \nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/lib/python2.7/site-packages/pyspark/ml/base.py\", line 129, in fit\n    return self._fit(dataset)\n  File \"/usr/lib/python2.7/site-packages/pyspark/ml/tuning.py\", line 436, in _fit\n    for j, metric, subModel in pool.imap_unordered(lambda f: f(), tasks):\n  File \"/usr/lib64/python2.7/multiprocessing/pool.py\", line 655, in next\n    raise value\npyspark.sql.utils.IllegalArgumentException: requirement failed: Column prediction must be of type equal to one of the following types: [array<double>, array<double>] but was actually of type float.\n"}]},"apps":[],"jobName":"paragraph_1683553917145_1898299752","id":"20230508-135157_48305207","dateCreated":"2023-05-08T13:51:57+0000","dateStarted":"2023-05-10T17:59:15+0000","dateFinished":"2023-05-10T18:21:31+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:2210"},{"text":"als_prediction = als_cvModel.transform(test)\nals_prediction.show(10)\nmap = als_cvModel.avgMetrics[0]\nprint(\"Mean average precision = \" + str(map))","user":"anonymous","dateUpdated":"2023-05-08T22:18:32+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1683584311044_-600873391","id":"20230508-221831_682799345","dateCreated":"2023-05-08T22:18:31+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:2211"},{"text":"from pyspark.ml.evaluation import RegressionEvaluator\n\nals_prediction = als_cvModel.transform(test).select(\"user_id\", \"isbn\", \"rating\", \"prediction\")\nevaluator = RegressionEvaluator(labelCol=\"rating\", predictionCol=\"prediction\", metricName=\"rmse\")\nrmse = evaluator.evaluate(als_prediction)\nprint(\"RMSE = \" + str(rmse))","user":"anonymous","dateUpdated":"2023-05-08T21:50:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"Traceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/lib/python2.7/site-packages/pyspark/sql/dataframe.py\", line 2096, in withColumn\n    return DataFrame(self._jdf.withColumn(colName, col._jc), self.sql_ctx)\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n  File \"/usr/lib/python2.7/site-packages/pyspark/sql/utils.py\", line 134, in deco\n    raise_from(converted)\n  File \"/usr/lib/python2.7/site-packages/pyspark/sql/utils.py\", line 33, in raise_from\n    raise e\npyspark.sql.utils.AnalysisException: cannot resolve '`prediction`' due to data type mismatch: cannot cast float to array<double>;;\n'Project [user_id#10662, isbn#10692, rating#10664, cast(prediction#29121 as array<double>) AS prediction#29136]\n+- Project [user_id#10662, isbn#10692, rating#10664, prediction#29121]\n   +- Filter AtLeastNNulls(n, prediction#29121)\n      +- Project [user_id#10662, rating#10664, isbn#10692, features#10725, UDF(features#13281, features#13293) AS prediction#29121]\n         +- Join LeftOuter, (UDF(isbn#10692) = id#13292)\n            :- Join LeftOuter, (UDF(user_id#10662) = id#13280)\n            :  :- Project [user_id#10662, rating#10664, isbn#10692, UDF(struct(user_id_double_VectorAssembler_c676e68c341e, cast(user_id#10662 as double), isbn_double_VectorAssembler_c676e68c341e, cast(isbn#10692 as double))) AS features#10725]\n            :  :  +- Sample 0.7, 1.0, false, 904289946297931841\n            :  :     +- Sort [user_id#10662 ASC NULLS FIRST, rating#10664 ASC NULLS FIRST, isbn#10692 ASC NULLS FIRST], false\n            :  :        +- Filter AtLeastNNulls(n, isbn#10692)\n            :  :           +- Project [user_id#10662, rating#10664, isbn#10692]\n            :  :              +- Project [user_id#10662, rating#10664, clean_isbn#10684, cast(clean_isbn#10684 as int) AS isbn#10692]\n            :  :                 +- Project [user_id#10662, rating#10664, clean_isbn#10684]\n            :  :                    +- Project [user_id#10662, isbn#10663, rating#10664, regexp_replace(isbn#10663, (x|X)$, ) AS clean_isbn#10684]\n            :  :                       +- SubqueryAlias spark_catalog.projectdb.book_ratings\n            :  :                          +- HiveTableRelation `projectdb`.`book_ratings`, org.apache.hadoop.hive.serde2.avro.AvroSerDe, [user_id#10662, isbn#10663, rating#10664]\n            :  +- Project [_1#13275 AS id#13280, _2#13276 AS features#13281]\n            :     +- SerializeFromObject [knownnotnull(assertnotnull(input[0, scala.Tuple2, true]))._1 AS _1#13275, staticinvoke(class org.apache.spark.sql.catalyst.expressions.UnsafeArrayData, ArrayType(FloatType,false), fromPrimitiveArray, knownnotnull(assertnotnull(input[0, scala.Tuple2, true]))._2, true, false) AS _2#13276]\n            :        +- ExternalRDD [obj#13274]\n            +- Project [_1#13287 AS id#13292, _2#13288 AS features#13293]\n               +- SerializeFromObject [knownnotnull(assertnotnull(input[0, scala.Tuple2, true]))._1 AS _1#13287, staticinvoke(class org.apache.spark.sql.catalyst.expressions.UnsafeArrayData, ArrayType(FloatType,false), fromPrimitiveArray, knownnotnull(assertnotnull(input[0, scala.Tuple2, true]))._2, true, false) AS _2#13288]\n                  +- ExternalRDD [obj#13286]\n\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nAttributeError: 'ALS' object has no attribute 'show'\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/lib/python2.7/site-packages/pyspark/ml/evaluation.py\", line 72, in evaluate\n    return self._evaluate(dataset)\n  File \"/usr/lib/python2.7/site-packages/pyspark/ml/evaluation.py\", line 102, in _evaluate\n    return self._java_obj.evaluate(dataset._jdf)\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1305, in __call__\n    answer, self.gateway_client, self.target_id, self.name)\n  File \"/usr/lib/python2.7/site-packages/pyspark/sql/utils.py\", line 134, in deco\n    raise_from(converted)\n  File \"/usr/lib/python2.7/site-packages/pyspark/sql/utils.py\", line 33, in raise_from\n    raise e\npyspark.sql.utils.IllegalArgumentException: requirement failed: Column prediction must be of type equal to one of the following types: [array<double>, array<double>] but was actually of type float.\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\nNameError: name 'ndcg' is not defined\n"}]},"apps":[],"jobName":"paragraph_1683566257633_-336210623","id":"20230508-171737_2136927533","dateCreated":"2023-05-08T17:17:37+0000","dateStarted":"2023-05-08T20:33:47+0000","dateFinished":"2023-05-08T20:33:47+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:2212"},{"text":"single_user = test.filter(test['user_id']==148744).select(['user_id', 'isbn'])\nrecomendations = als_cvModel.transform(single_user)\nrecomendations.orderBy('prediction',ascending=False).show()","user":"anonymous","dateUpdated":"2023-05-08T19:53:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\n[Stage 2481:>(5 + 4) / 10][Stage 2483:>(0 + 0) / 10][Stage 2484:> (0 + 0) / 1]\n\n[Stage 2481:>(9 + 1) / 10][Stage 2483:>(0 + 3) / 10][Stage 2484:> (0 + 0) / 1]\n\n[Stage 2481:>(9 + 1) / 10][Stage 2483:>(1 + 3) / 10][Stage 2484:> (0 + 0) / 1]\n\n[Stage 2483:====>          (3 + 4) / 10][Stage 2484:>               (0 + 0) / 1]\n\n[Stage 2483:==========>    (7 + 3) / 10][Stage 2484:>               (0 + 1) / 1]\n\n[Stage 2484:>                                                       (0 + 1) / 1]\n\n                                                                                \n+-------+----------+----------+\n|user_id|      isbn|prediction|\n+-------+----------+----------+\n| 148744| 517207346|  5.619839|\n| 148744| 671867873| 5.5692654|\n| 148744| 152956026|  5.354501|\n| 148744| 590444646| 4.5899324|\n| 148744| 451206002| 4.0816393|\n| 148744|1580621805| 3.7835631|\n| 148744| 399143696| 3.6956148|\n| 148744| 449003701| 3.6819444|\n| 148744|1568361742| 3.4094224|\n| 148744| 380705354| 3.3532686|\n| 148744| 440407524| 3.3428888|\n| 148744| 553212338| 3.2844625|\n| 148744| 553257048|  3.278731|\n| 148744| 446404039| 3.1143699|\n| 148744| 380788756| 3.0385485|\n| 148744|  82177462| 3.0139554|\n| 148744| 446603716| 2.9028225|\n| 148744| 871234017|    2.8893|\n| 148744| 345344855| 2.8464856|\n| 148744|1551660253|  2.740789|\n+-------+----------+----------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1683570286825_-1386998216","id":"20230508-182446_1936431780","dateCreated":"2023-05-08T18:24:46+0000","dateStarted":"2023-05-08T19:53:39+0000","dateFinished":"2023-05-08T19:53:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2213"},{"text":"# cross validation and hyperparameter tuning.\nfrom pyspark.ml import Pipeline\nfrom pyspark.ml.tuning import CrossValidator, ParamGridBuilder\nfrom pyspark.ml.evaluation import RegressionEvaluator\nfrom pyspark.ml.regression import RandomForestRegressor\n\nrf = RandomForestRegressor(featuresCol=\"features\", labelCol=\"rating\")\npipeline = Pipeline(stages=[rf])\nparamGrid = ParamGridBuilder().addGrid(rf.maxDepth, [5, 10, 15]).addGrid(rf.numTrees, [2, 5, 10]).build()\n\ncrossval = CrossValidator(estimator=pipeline, estimatorParamMaps=paramGrid, evaluator=RegressionEvaluator(metricName=\"rmse\", labelCol=\"rating\", predictionCol=\"prediction\"),numFolds=4)\n\nrf_cvModel = crossval.fit(training)\nrf_prediction = rf_cvModel.transform(test)\nrf_prediction.show(10)","user":"anonymous","dateUpdated":"2023-05-08T21:40:14+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"ERROR","msg":[{"type":"TEXT","data":"23/05/08 21:39:09 ERROR util.Instrumentation: java.lang.IllegalStateException: SparkContext has been shutdown\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2106)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2135)\n\tat org.apache.spark.SparkContext.runJob(SparkContext.scala:2154)\n\tat org.apache.spark.rdd.RDD.$anonfun$take$1(RDD.scala:1423)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n\tat org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n\tat org.apache.spark.rdd.RDD.withScope(RDD.scala:388)\n\tat org.apache.spark.rdd.RDD.take(RDD.scala:1396)\n\tat org.apache.spark.ml.tree.impl.DecisionTreeMetadata$.buildMetadata(DecisionTreeMetadata.scala:119)\n\tat org.apache.spark.ml.tree.impl.RandomForest$.run(RandomForest.scala:274)\n\tat org.apache.spark.ml.regression.RandomForestRegressor.$anonfun$train$1(RandomForestRegressor.scala:150)\n\tat org.apache.spark.ml.util.Instrumentation$.$anonfun$instrumented$1(Instrumentation.scala:191)\n\tat scala.util.Try$.apply(Try.scala:213)\n\tat org.apache.spark.ml.util.Instrumentation$.instrumented(Instrumentation.scala:191)\n\tat org.apache.spark.ml.regression.RandomForestRegressor.train(RandomForestRegressor.scala:134)\n\tat org.apache.spark.ml.regression.RandomForestRegressor.train(RandomForestRegressor.scala:43)\n\tat org.apache.spark.ml.Predictor.fit(Predictor.scala:150)\n\tat org.apache.spark.ml.Predictor.fit(Predictor.scala:114)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat py4j.reflection.MethodInvoker.invoke(MethodInvoker.java:244)\n\tat py4j.reflection.ReflectionEngine.invoke(ReflectionEngine.java:357)\n\tat py4j.Gateway.invoke(Gateway.java:282)\n\tat py4j.commands.AbstractCommand.invokeMethod(AbstractCommand.java:132)\n\tat py4j.commands.CallCommand.execute(CallCommand.java:79)\n\tat py4j.GatewayConnection.run(GatewayConnection.java:238)\n\tat java.lang.Thread.run(Thread.java:748)\n\nERROR:root:Exception while sending command.\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1033, in send_command\n    response = connection.send_command(command)\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1212, in send_command\n    \"Error while receiving\", e, proto.ERROR_ON_RECEIVE)\nPy4JNetworkError: Error while receiving\nERROR:root:Exception while sending command.\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1033, in send_command\n    response = connection.send_command(command)\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1212, in send_command\n    \"Error while receiving\", e, proto.ERROR_ON_RECEIVE)\nPy4JNetworkError: Error while receiving\nERROR:py4j.java_gateway:An error occurred while trying to connect to the Java server (127.0.0.1:34247)\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1115, in start\n    self.socket.connect((self.address, self.port))\n  File \"/usr/lib64/python2.7/socket.py\", line 224, in meth\n    return getattr(self._sock,name)(*args)\nerror: [Errno 111] Connection refused\nERROR:py4j.java_gateway:An error occurred while trying to connect to the Java server (127.0.0.1:34247)\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1115, in start\n    self.socket.connect((self.address, self.port))\n  File \"/usr/lib64/python2.7/socket.py\", line 224, in meth\n    return getattr(self._sock,name)(*args)\nerror: [Errno 111] Connection refused\nERROR:py4j.java_gateway:An error occurred while trying to connect to the Java server (127.0.0.1:34247)\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1115, in start\n    self.socket.connect((self.address, self.port))\n  File \"/usr/lib64/python2.7/socket.py\", line 224, in meth\n    return getattr(self._sock,name)(*args)\nerror: [Errno 111] Connection refused\nERROR:py4j.java_gateway:An error occurred while trying to connect to the Java server (127.0.0.1:34247)\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1115, in start\n    self.socket.connect((self.address, self.port))\n  File \"/usr/lib64/python2.7/socket.py\", line 224, in meth\n    return getattr(self._sock,name)(*args)\nerror: [Errno 111] Connection refused\nERROR:py4j.java_gateway:An error occurred while trying to connect to the Java server (127.0.0.1:34247)\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1115, in start\n    self.socket.connect((self.address, self.port))\n  File \"/usr/lib64/python2.7/socket.py\", line 224, in meth\n    return getattr(self._sock,name)(*args)\nerror: [Errno 111] Connection refused\nERROR:py4j.java_gateway:An error occurred while trying to connect to the Java server (127.0.0.1:34247)\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1115, in start\n    self.socket.connect((self.address, self.port))\n  File \"/usr/lib64/python2.7/socket.py\", line 224, in meth\n    return getattr(self._sock,name)(*args)\nerror: [Errno 111] Connection refused\nERROR:py4j.java_gateway:An error occurred while trying to connect to the Java server (127.0.0.1:34247)\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1115, in start\n    self.socket.connect((self.address, self.port))\n  File \"/usr/lib64/python2.7/socket.py\", line 224, in meth\n    return getattr(self._sock,name)(*args)\nerror: [Errno 111] Connection refused\nERROR:py4j.java_gateway:An error occurred while trying to connect to the Java server (127.0.0.1:34247)\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1115, in start\n    self.socket.connect((self.address, self.port))\n  File \"/usr/lib64/python2.7/socket.py\", line 224, in meth\n    return getattr(self._sock,name)(*args)\nerror: [Errno 111] Connection refused\nERROR:py4j.java_gateway:An error occurred while trying to connect to the Java server (127.0.0.1:34247)\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1115, in start\n    self.socket.connect((self.address, self.port))\n  File \"/usr/lib64/python2.7/socket.py\", line 224, in meth\n    return getattr(self._sock,name)(*args)\nerror: [Errno 111] Connection refused\nERROR:py4j.java_gateway:An error occurred while trying to connect to the Java server (127.0.0.1:34247)\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1115, in start\n    self.socket.connect((self.address, self.port))\n  File \"/usr/lib64/python2.7/socket.py\", line 224, in meth\n    return getattr(self._sock,name)(*args)\nerror: [Errno 111] Connection refused\nERROR:py4j.java_gateway:An error occurred while trying to connect to the Java server (127.0.0.1:34247)\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1115, in start\n    self.socket.connect((self.address, self.port))\n  File \"/usr/lib64/python2.7/socket.py\", line 224, in meth\n    return getattr(self._sock,name)(*args)\nerror: [Errno 111] Connection refused\nERROR:py4j.java_gateway:An error occurred while trying to connect to the Java server (127.0.0.1:34247)\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1115, in start\n    self.socket.connect((self.address, self.port))\n  File \"/usr/lib64/python2.7/socket.py\", line 224, in meth\n    return getattr(self._sock,name)(*args)\nerror: [Errno 111] Connection refused\n ERROR:py4j.java_gateway:An error occurred while trying to connect to the Java server (127.0.0.1:34247)\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1115, in start\n    self.socket.connect((self.address, self.port))\n  File \"/usr/lib64/python2.7/socket.py\", line 224, in meth\n    return getattr(self._sock,name)(*args)\nerror: [Errno 111] Connection refused\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/lib/python2.7/site-packages/pyspark/__init__.py\", line 110, in wrapper\n    return func(self, **kwargs)\n  File \"/usr/lib/python2.7/site-packages/pyspark/ml/regression.py\", line 1124, in __init__\n    \"org.apache.spark.ml.regression.RandomForestRegressor\", self.uid)\n  File \"/usr/lib/python2.7/site-packages/pyspark/ml/wrapper.py\", line 67, in _new_java_obj\n    java_obj = getattr(java_obj, name)\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1695, in __getattr__\n    \"\\n\" + proto.END_COMMAND_PART)\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1031, in send_command\n    connection = self._get_connection()\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 979, in _get_connection\n    connection = self._create_connection()\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 985, in _create_connection\n    connection.start()\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1127, in start\n    raise Py4JNetworkError(msg, e)\npy4j.protocol.Py4JNetworkError: An error occurred while trying to connect to the Java server (127.0.0.1:34247)\nERROR:py4j.java_gateway:An error occurred while trying to connect to the Java server (127.0.0.1:34247)\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1115, in start\n    self.socket.connect((self.address, self.port))\n  File \"/usr/lib64/python2.7/socket.py\", line 224, in meth\n    return getattr(self._sock,name)(*args)\nerror: [Errno 111] Connection refused\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/lib/python2.7/site-packages/pyspark/__init__.py\", line 110, in wrapper\n    return func(self, **kwargs)\n  File \"/usr/lib/python2.7/site-packages/pyspark/ml/evaluation.py\", line 293, in __init__\n    \"org.apache.spark.ml.evaluation.RegressionEvaluator\", self.uid)\n  File \"/usr/lib/python2.7/site-packages/pyspark/ml/wrapper.py\", line 67, in _new_java_obj\n    java_obj = getattr(java_obj, name)\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1695, in __getattr__\n    \"\\n\" + proto.END_COMMAND_PART)\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1031, in send_command\n    connection = self._get_connection()\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 979, in _get_connection\n    connection = self._create_connection()\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 985, in _create_connection\n    connection.start()\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1127, in start\n    raise Py4JNetworkError(msg, e)\npy4j.protocol.Py4JNetworkError: An error occurred while trying to connect to the Java server (127.0.0.1:34247)\nERROR:py4j.java_gateway:An error occurred while trying to connect to the Java server (127.0.0.1:34247)\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1115, in start\n    self.socket.connect((self.address, self.port))\n  File \"/usr/lib64/python2.7/socket.py\", line 224, in meth\n    return getattr(self._sock,name)(*args)\nerror: [Errno 111] Connection refused\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/lib/python2.7/site-packages/pyspark/ml/base.py\", line 129, in fit\n    return self._fit(dataset)\n  File \"/usr/lib/python2.7/site-packages/pyspark/ml/tuning.py\", line 419, in _fit\n    df = dataset.select(\"*\", rand(seed).alias(randCol))\n  File \"/usr/lib/python2.7/site-packages/pyspark/sql/functions.py\", line 612, in rand\n    jc = sc._jvm.functions.rand(seed)\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1695, in __getattr__\n    \"\\n\" + proto.END_COMMAND_PART)\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1031, in send_command\n    connection = self._get_connection()\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 979, in _get_connection\n    connection = self._create_connection()\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 985, in _create_connection\n    connection.start()\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1127, in start\n    raise Py4JNetworkError(msg, e)\npy4j.protocol.Py4JNetworkError: An error occurred while trying to connect to the Java server (127.0.0.1:34247)\nERROR:py4j.java_gateway:An error occurred while trying to connect to the Java server (127.0.0.1:34247)\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1115, in start\n    self.socket.connect((self.address, self.port))\n  File \"/usr/lib64/python2.7/socket.py\", line 224, in meth\n    return getattr(self._sock,name)(*args)\nerror: [Errno 111] Connection refused\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/lib/python2.7/site-packages/pyspark/ml/base.py\", line 170, in transform\n    return self._transform(dataset)\n  File \"/usr/lib/python2.7/site-packages/pyspark/ml/tuning.py\", line 543, in _transform\n    return self.bestModel.transform(dataset)\n  File \"/usr/lib/python2.7/site-packages/pyspark/ml/base.py\", line 170, in transform\n    return self._transform(dataset)\n  File \"/usr/lib/python2.7/site-packages/pyspark/ml/pipeline.py\", line 262, in _transform\n    dataset = t.transform(dataset)\n  File \"/usr/lib/python2.7/site-packages/pyspark/ml/base.py\", line 170, in transform\n    return self._transform(dataset)\n  File \"/usr/lib/python2.7/site-packages/pyspark/ml/wrapper.py\", line 337, in _transform\n    self._transfer_params_to_java()\n  File \"/usr/lib/python2.7/site-packages/pyspark/ml/wrapper.py\", line 145, in _transfer_params_to_java\n    pair = self._make_java_param_pair(param, self._defaultParamMap[param])\n  File \"/usr/lib/python2.7/site-packages/pyspark/ml/wrapper.py\", line 131, in _make_java_param_pair\n    java_param = self._java_obj.getParam(param.name)\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1303, in __call__\n    answer = self.gateway_client.send_command(command)\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1031, in send_command\n    connection = self._get_connection()\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 979, in _get_connection\n    connection = self._create_connection()\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 985, in _create_connection\n    connection.start()\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1127, in start\n    raise Py4JNetworkError(msg, e)\npy4j.protocol.Py4JNetworkError: An error occurred while trying to connect to the Java server (127.0.0.1:34247)\nERROR:py4j.java_gateway:An error occurred while trying to connect to the Java server (127.0.0.1:34247)\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1115, in start\n    self.socket.connect((self.address, self.port))\n  File \"/usr/lib64/python2.7/socket.py\", line 224, in meth\n    return getattr(self._sock,name)(*args)\nerror: [Errno 111] Connection refused\nTraceback (most recent call last):\n  File \"<stdin>\", line 1, in <module>\n  File \"/usr/lib/python2.7/site-packages/pyspark/sql/dataframe.py\", line 440, in show\n    print(self._jdf.showString(n, 20, vertical))\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1303, in __call__\n    answer = self.gateway_client.send_command(command)\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1031, in send_command\n    connection = self._get_connection()\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 979, in _get_connection\n    connection = self._create_connection()\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 985, in _create_connection\n    connection.start()\n  File \"/usr/lib/python2.7/site-packages/py4j/java_gateway.py\", line 1127, in start\n    raise Py4JNetworkError(msg, e)\npy4j.protocol.Py4JNetworkError: An error occurred while trying to connect to the Java server (127.0.0.1:34247)\n"}]},"apps":[],"jobName":"paragraph_1683566257149_-137680190","id":"20230508-171737_1116299414","dateCreated":"2023-05-08T17:17:37+0000","dateStarted":"2023-05-08T21:40:15+0000","dateFinished":"2023-05-08T21:40:15+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:2214"},{"text":"from pyspark.ml.evaluation import RegressionEvaluator\n\nevaluator = RegressionEvaluator(metricName=\"rmse\", labelCol=\"rating\",predictionCol=\"prediction\")\nrmse = evaluator.evaluate(dt_prediction)\nprint(\"Root-mean-square error = \" + str(rmse))","user":"anonymous","dateUpdated":"2023-05-08T20:48:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\n[Stage 6007:>                                                       (0 + 1) / 1]\n\n                                                                                \nRoot-mean-square error = 3.82882965062\n"}]},"apps":[],"jobName":"paragraph_1683566252066_368634038","id":"20230508-171732_1690472029","dateCreated":"2023-05-08T17:17:32+0000","dateStarted":"2023-05-08T20:48:48+0000","dateFinished":"2023-05-08T20:48:51+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2215"},{"text":"single_user = test.filter(test['user_id']==148744).select(['features', 'rating'])\nrecomendations = rf_cvModel.transform(single_user)\nrecomendations = recomendations.orderBy('prediction',ascending=False)\nrecomendations.show()","user":"anonymous","dateUpdated":"2023-05-08T20:00:35+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\n[Stage 1964:>                                                       (0 + 1) / 1]\n\n                                                                                \n+--------------------+------+------------------+\n|            features|rating|        prediction|\n+--------------------+------+------------------+\n|[148744.0,1.58062...|     0|3.5275161130391672|\n|[148744.0,1.87842...|     0|3.5275161130391672|\n|[148744.0,1.57673...|     0|3.5275161130391672|\n|[148744.0,1.57731...|     0|3.5275161130391672|\n|[148744.0,1.57034...|     0|3.2045833965700408|\n|[148744.0,1.52956...|     0|3.2045833965700408|\n|[148744.0,1.55817...|     0|3.2045833965700408|\n|[148744.0,1.57322...|     0|3.2045833965700408|\n|[148744.0,1.51002...|     0|3.2045833965700408|\n|[148744.0,6.89710...|     0| 3.178520625889047|\n|[148744.0,6.79740...|     0| 3.178520625889047|\n|[148744.0,6.79767...|     0| 3.178520625889047|\n|[148744.0,6.88142...|     0| 3.178520625889047|\n|[148744.0,6.89704...|     0| 3.178520625889047|\n|[148744.0,6.84800...|     0| 3.178520625889047|\n|[148744.0,6.84826...|     0| 3.178520625889047|\n|[148744.0,6.88180...|     0| 3.178520625889047|\n|[148744.0,6.89121...|     0| 3.178520625889047|\n|[148744.0,6.89840...|     0| 3.178520625889047|\n|[148744.0,6.84868...|     0| 3.178520625889047|\n+--------------------+------+------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1683566251937_-863716689","id":"20230508-171731_7199345","dateCreated":"2023-05-08T17:17:31+0000","dateStarted":"2023-05-08T18:49:27+0000","dateFinished":"2023-05-08T18:49:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2216"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1683566251369_-743675032","id":"20230508-171731_1714987944","dateCreated":"2023-05-08T17:17:31+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:2217"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1683566250597_-643640318","id":"20230508-171730_712938708","dateCreated":"2023-05-08T17:17:30+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:2218"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1683553916661_508586725","id":"20230508-135156_322860034","dateCreated":"2023-05-08T13:51:56+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:2219"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1683553916334_820618082","id":"20230508-135156_1272378759","dateCreated":"2023-05-08T13:51:56+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:2220"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1683553916034_739051316","id":"20230508-135156_118017559","dateCreated":"2023-05-08T13:51:56+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:2221"}],"name":"project","id":"2J2N21FC5","angularObjects":{"2J1S2S553:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}